// City configurations for simulation
// Routes use REAL GPS coordinates from OpenStreetMap via OSRM routing

export const cities = {
  noviSad: {
    id: 'noviSad',
    name: 'Novi Sad',
    center: [45.2551, 19.8452],
    zoom: 14,
    busCount: 10,
    routes: [
      {
        id: 'ns-4',
        name: 'Linija 4',
        fullName: 'Liman IV - Centar - Železnička stanica',
        color: '#00d4ff',
        // OSRM route: Liman IV → Bulevar Cara Lazara → Centar → Železnička
        coordinates: [
          [45.2356, 19.8291],
          [45.2357, 19.8296],
          [45.2358, 19.8302],
          [45.2364, 19.8297],
          [45.2372, 19.8299],
          [45.2381, 19.8303],
          [45.2388, 19.8307],
          [45.2391, 19.8318],
          [45.2395, 19.8330],
          [45.2399, 19.8345],
          [45.2412, 19.8377],
          [45.2415, 19.8384],
          [45.2427, 19.8418],
          [45.2434, 19.8437],
          [45.2444, 19.8464],
          [45.2452, 19.8483],
          [45.2468, 19.8473],
          [45.2479, 19.8468],
          [45.2489, 19.8459],
          [45.2500, 19.8450],
          [45.2508, 19.8446],
          [45.2518, 19.8440],
          [45.2528, 19.8434],
          [45.2536, 19.8426],
          [45.2537, 19.8414],
          [45.2545, 19.8404],
          [45.2558, 19.8392],
          [45.2576, 19.8379],
          [45.2589, 19.8365],
          [45.2604, 19.8349],
          [45.2619, 19.8332],
          [45.2635, 19.8315],
          [45.2649, 19.8302],
          [45.2656, 19.8294],
        ],
        stations: ['ns-station-1', 'ns-station-2'],
      },
      {
        id: 'ns-7',
        name: 'Linija 7A',
        fullName: 'Novo Naselje - Centar - Liman IV',
        color: '#7c3aed',
        // OSRM route: Novo Naselje → Centar → Liman
        coordinates: [
          [45.2596, 19.8048],
          [45.2594, 19.8050],
          [45.2583, 19.8029],
          [45.2576, 19.8012],
          [45.2570, 19.8017],
          [45.2557, 19.8029],
          [45.2537, 19.8057],
          [45.2515, 19.8092],
          [45.2494, 19.8130],
          [45.2488, 19.8150],
          [45.2491, 19.8175],
          [45.2493, 19.8200],
          [45.2496, 19.8228],
          [45.2498, 19.8260],
          [45.2501, 19.8293],
          [45.2508, 19.8320],
          [45.2517, 19.8345],
          [45.2528, 19.8370],
          [45.2537, 19.8392],
          [45.2543, 19.8414],
          [45.2536, 19.8433],
          [45.2528, 19.8448],
          [45.2517, 19.8475],
          [45.2500, 19.8466],
          [45.2485, 19.8455],
          [45.2468, 19.8442],
          [45.2450, 19.8428],
          [45.2430, 19.8413],
          [45.2408, 19.8397],
          [45.2390, 19.8380],
          [45.2375, 19.8360],
          [45.2362, 19.8330],
          [45.2356, 19.8298],
        ],
        stations: ['ns-station-1', 'ns-station-3'],
      },
      {
        id: 'ns-11a',
        name: 'Linija 11A',
        fullName: 'Železnička stanica - Bolnica - Liman',
        color: '#22c55e',
        // OSRM route: Železnička → Centar → Liman
        coordinates: [
          [45.2656, 19.8294],
          [45.2649, 19.8302],
          [45.2635, 19.8315],
          [45.2619, 19.8332],
          [45.2604, 19.8349],
          [45.2589, 19.8365],
          [45.2576, 19.8379],
          [45.2558, 19.8392],
          [45.2545, 19.8404],
          [45.2537, 19.8414],
          [45.2536, 19.8426],
          [45.2528, 19.8440],
          [45.2518, 19.8450],
          [45.2505, 19.8458],
          [45.2488, 19.8448],
          [45.2472, 19.8435],
          [45.2455, 19.8420],
          [45.2438, 19.8405],
          [45.2420, 19.8388],
          [45.2400, 19.8370],
          [45.2382, 19.8352],
          [45.2368, 19.8330],
          [45.2358, 19.8310],
          [45.2356, 19.8298],
        ],
        stations: ['ns-station-2', 'ns-station-3'],
      },
      {
        id: 'ns-3',
        name: 'Linija 3',
        fullName: 'Detelinara - Centar - Petrovaradin',
        color: '#f59e0b',
        // OSRM route: Detelinara → Centar → Petrovaradin
        coordinates: [
          [45.2715, 19.8332],
          [45.2720, 19.8342],
          [45.2695, 19.8349],
          [45.2688, 19.8365],
          [45.2677, 19.8380],
          [45.2665, 19.8395],
          [45.2652, 19.8410],
          [45.2638, 19.8422],
          [45.2622, 19.8435],
          [45.2605, 19.8445],
          [45.2588, 19.8455],
          [45.2570, 19.8462],
          [45.2551, 19.8468],
          [45.2536, 19.8480],
          [45.2525, 19.8505],
          [45.2518, 19.8535],
          [45.2514, 19.8568],
          [45.2512, 19.8598],
          [45.2515, 19.8628],
          [45.2520, 19.8655],
          [45.2522, 19.8622],
        ],
        stations: ['ns-station-1'],
      },
    ],
    stations: [
      {
        id: 'ns-station-1',
        name: 'Trg Slobode',
        position: [45.2551, 19.8452],
        maxPower: 252,
        chargingPoints: 6,
        batteryStorage: 12,
        type: 'depot',
        hasRobotA: true,
        hasRobotB: true,
      },
      {
        id: 'ns-station-2',
        name: 'Železnička Stanica',
        position: [45.2656, 19.8294],
        maxPower: 150,
        chargingPoints: 4,
        batteryStorage: 0,
        type: 'opportunity',
        hasRobotA: false,
        hasRobotB: false,
      },
      {
        id: 'ns-station-3',
        name: 'Liman IV',
        position: [45.2356, 19.8298],
        maxPower: 180,
        chargingPoints: 4,
        batteryStorage: 8,
        type: 'opportunity',
        hasRobotA: true,
        hasRobotB: true,
      },
    ],
  },

  beograd: {
    id: 'beograd',
    name: 'Beograd',
    center: [44.8125, 20.4612],
    zoom: 13,
    busCount: 10,
    routes: [
      {
        id: 'bg-26',
        name: 'Linija 26',
        fullName: 'Vukov Spomenik - Studentski Trg',
        color: '#00d4ff',
        // OSRM: Vukov Spomenik → Ruzveltova → Studentski Trg
        coordinates: [
          [44.8045, 20.4832],
          [44.8043, 20.4829],
          [44.8047, 20.4823],
          [44.8053, 20.4813],
          [44.8057, 20.4806],
          [44.8061, 20.4795],
          [44.8066, 20.4781],
          [44.8071, 20.4768],
          [44.8078, 20.4752],
          [44.8085, 20.4735],
          [44.8094, 20.4716],
          [44.8101, 20.4698],
          [44.8109, 20.4679],
          [44.8116, 20.4660],
          [44.8124, 20.4640],
          [44.8132, 20.4620],
          [44.8143, 20.4594],
          [44.8151, 20.4577],
          [44.8158, 20.4561],
          [44.8165, 20.4652],
          [44.8167, 20.4648],
          [44.8168, 20.4628],
          [44.8177, 20.4610],
          [44.8181, 20.4606],
          [44.8193, 20.4594],
          [44.8193, 20.4556],
        ],
        stations: ['bg-station-1'],
      },
      {
        id: 'bg-31',
        name: 'Linija 31',
        fullName: 'Karaburma - Studentski Trg',
        color: '#7c3aed',
        // OSRM: Karaburma → Cvijiceva → Studentski Trg
        coordinates: [
          [44.8144, 20.4889],
          [44.8143, 20.4893],
          [44.8142, 20.4883],
          [44.8138, 20.4870],
          [44.8128, 20.4848],
          [44.8117, 20.4831],
          [44.8131, 20.4814],
          [44.8129, 20.4788],
          [44.8130, 20.4763],
          [44.8134, 20.4830],
          [44.8148, 20.4815],
          [44.8151, 20.4802],
          [44.8151, 20.4780],
          [44.8151, 20.4757],
          [44.8168, 20.4768],
          [44.8168, 20.4750],
          [44.8169, 20.4687],
          [44.8168, 20.4668],
          [44.8166, 20.4649],
          [44.8165, 20.4632],
          [44.8166, 20.4627],
          [44.8172, 20.4610],
          [44.8180, 20.4596],
          [44.8188, 20.4582],
          [44.8193, 20.4556],
        ],
        stations: ['bg-station-1'],
      },
      {
        id: 'bg-65',
        name: 'Linija 65',
        fullName: 'Zeleni Venac - Novi Beograd',
        color: '#22c55e',
        // OSRM: Zeleni Venac → Brankov most → Novi Beograd
        coordinates: [
          [44.8139, 20.4545],
          [44.8138, 20.4541],
          [44.8141, 20.4536],
          [44.8143, 20.4528],
          [44.8146, 20.4515],
          [44.8149, 20.4502],
          [44.8152, 20.4486],
          [44.8157, 20.4468],
          [44.8162, 20.4448],
          [44.8166, 20.4430],
          [44.8147, 20.4397],
          [44.8146, 20.4375],
          [44.8144, 20.4352],
          [44.8145, 20.4328],
          [44.8143, 20.4302],
          [44.8140, 20.4279],
          [44.8138, 20.4254],
          [44.8137, 20.4229],
          [44.8136, 20.4205],
          [44.8135, 20.4180],
          [44.8134, 20.4158],
        ],
        stations: ['bg-station-1', 'bg-station-2'],
      },
      {
        id: 'bg-78',
        name: 'Linija 78',
        fullName: 'Slavija - Banovo Brdo',
        color: '#f59e0b',
        // OSRM: Slavija → Topcider → Banovo Brdo
        coordinates: [
          [44.8026, 20.4667],
          [44.8027, 20.4666],
          [44.8017, 20.4665],
          [44.8016, 20.4655],
          [44.8035, 20.4627],
          [44.8028, 20.4637],
          [44.8026, 20.4628],
          [44.8019, 20.4603],
          [44.8017, 20.4577],
          [44.8012, 20.4560],
          [44.8004, 20.4547],
          [44.7996, 20.4529],
          [44.7988, 20.4508],
          [44.7979, 20.4585],
          [44.7969, 20.4564],
          [44.7958, 20.4541],
          [44.7948, 20.4518],
          [44.7936, 20.4495],
          [44.7920, 20.4470],
          [44.7903, 20.4443],
          [44.7886, 20.4418],
          [44.7869, 20.4393],
          [44.7854, 20.4370],
          [44.7840, 20.4350],
          [44.7830, 20.4332],
          [44.7821, 20.4310],
          [44.7815, 20.4288],
          [44.7815, 20.4261],
        ],
        stations: ['bg-station-1'],
      },
    ],
    stations: [
      {
        id: 'bg-station-1',
        name: 'Zeleni Venac Depo',
        position: [44.8138, 20.4545],
        maxPower: 500,
        chargingPoints: 10,
        batteryStorage: 20,
        type: 'depot',
        hasRobotA: true,
        hasRobotB: true,
      },
      {
        id: 'bg-station-2',
        name: 'Novi Beograd',
        position: [44.8156, 20.4363],
        maxPower: 300,
        chargingPoints: 6,
        batteryStorage: 10,
        type: 'opportunity',
        hasRobotA: true,
        hasRobotB: false,
      },
    ],
  },

  kragujevac: {
    id: 'kragujevac',
    name: 'Kragujevac',
    center: [44.0167, 20.9167],
    zoom: 14,
    busCount: 10,
    routes: [
      {
        id: 'kg-1',
        name: 'Linija 1',
        fullName: 'Centar - Aerodrom',
        color: '#00d4ff',
        // OSRM: Centar → Lepenicki bulevar → Aerodrom
        coordinates: [
          [44.0169, 20.9170],
          [44.0167, 20.9173],
          [44.0161, 20.9166],
          [44.0160, 20.9164],
          [44.0183, 20.9136],
          [44.0183, 20.9131],
          [44.0188, 20.9129],
          [44.0192, 20.9119],
          [44.0194, 20.9102],
          [44.0198, 20.9100],
          [44.0200, 20.9082],
          [44.0213, 20.9057],
          [44.0223, 20.9040],
          [44.0253, 20.8994],
          [44.0263, 20.8981],
          [44.0275, 20.8816],
          [44.0281, 20.8879],
          [44.0288, 20.8826],
          [44.0294, 20.8812],
          [44.0301, 20.8804],
          [44.0318, 20.8827],
          [44.0324, 20.8821],
          [44.0332, 20.8815],
          [44.0347, 20.8807],
        ],
        stations: ['kg-station-1'],
      },
      {
        id: 'kg-2',
        name: 'Linija 2',
        fullName: 'Centar - Stanovo',
        color: '#7c3aed',
        // OSRM: Centar → Stanovo
        coordinates: [
          [44.0169, 20.9170],
          [44.0167, 20.9173],
          [44.0161, 20.9166],
          [44.0160, 20.9166],
          [44.0155, 20.9171],
          [44.0154, 20.9175],
          [44.0159, 20.9182],
          [44.0163, 20.9192],
          [44.0167, 20.9199],
          [44.0152, 20.9205],
          [44.0132, 20.9214],
          [44.0127, 20.9235],
          [44.0120, 20.9253],
          [44.0114, 20.9270],
          [44.0100, 20.9310],
          [44.0098, 20.9327],
          [44.0091, 20.9337],
          [44.0079, 20.9356],
          [44.0066, 20.9381],
          [44.0048, 20.9411],
          [44.0034, 20.9434],
          [44.0018, 20.9455],
        ],
        stations: ['kg-station-2'],
      },
      {
        id: 'kg-3',
        name: 'Linija 3',
        fullName: 'Centar - Bresnica',
        color: '#22c55e',
        // OSRM: Centar → Bresnica
        coordinates: [
          [44.0169, 20.9170],
          [44.0167, 20.9173],
          [44.0161, 20.9166],
          [44.0155, 20.9171],
          [44.0154, 20.9175],
          [44.0159, 20.9192],
          [44.0162, 20.9206],
          [44.0151, 20.9227],
          [44.0150, 20.9250],
          [44.0159, 20.9288],
          [44.0170, 20.9317],
          [44.0189, 20.9352],
          [44.0203, 20.9387],
          [44.0222, 20.9245],
          [44.0244, 20.9285],
          [44.0275, 20.9309],
          [44.0301, 20.9306],
          [44.0320, 20.9315],
          [44.0334, 20.9330],
          [44.0347, 20.9353],
          [44.0360, 20.9440],
        ],
        stations: ['kg-station-1', 'kg-station-3'],
      },
      {
        id: 'kg-4',
        name: 'Linija 4',
        fullName: 'Centar - Zastava',
        color: '#f59e0b',
        // OSRM: Centar → Zastava
        coordinates: [
          [44.0169, 20.9170],
          [44.0167, 20.9173],
          [44.0161, 20.9166],
          [44.0160, 20.9164],
          [44.0158, 20.9158],
          [44.0137, 20.9133],
          [44.0129, 20.9130],
          [44.0120, 20.9125],
          [44.0110, 20.9115],
          [44.0099, 20.9103],
          [44.0088, 20.9091],
          [44.0077, 20.9079],
          [44.0069, 20.9056],
          [44.0063, 20.9035],
          [44.0058, 20.9060],
          [44.0055, 20.9043],
          [44.0043, 20.8989],
          [44.0033, 20.8957],
          [44.0026, 20.8914],
          [44.0044, 20.8893],
          [44.0053, 20.8886],
          [44.0057, 20.8860],
        ],
        stations: ['kg-station-2', 'kg-station-3'],
      },
    ],
    stations: [
      {
        id: 'kg-station-1',
        name: 'Trg Radomira Putnika',
        position: [44.0167, 20.9167],
        maxPower: 252,
        chargingPoints: 6,
        batteryStorage: 12,
        type: 'depot',
        hasRobotA: true,
        hasRobotB: true,
      },
      {
        id: 'kg-station-2',
        name: 'Autobuska Stanica',
        position: [44.0095, 20.9305],
        maxPower: 150,
        chargingPoints: 4,
        batteryStorage: 0,
        type: 'opportunity',
        hasRobotA: false,
        hasRobotB: false,
      },
      {
        id: 'kg-station-3',
        name: 'Zastava',
        position: [44.0057, 20.8860],
        maxPower: 180,
        chargingPoints: 4,
        batteryStorage: 6,
        type: 'opportunity',
        hasRobotA: true,
        hasRobotB: true,
      },
    ],
  },
};

export function getCity(cityId) {
  return cities[cityId] || cities.noviSad;
}

export function interpolatePosition(route, progress) {
  const coords = route.coordinates;
  const totalSegments = coords.length - 1;
  const segmentProgress = progress * totalSegments;
  const segmentIndex = Math.min(Math.floor(segmentProgress), totalSegments - 1);
  const segmentLocalProgress = segmentProgress - segmentIndex;

  const start = coords[segmentIndex];
  const end = coords[segmentIndex + 1] || coords[segmentIndex];

  return [
    start[0] + (end[0] - start[0]) * segmentLocalProgress,
    start[1] + (end[1] - start[1]) * segmentLocalProgress,
  ];
}

export function getRouteById(cityId, routeId) {
  const city = getCity(cityId);
  return city.routes.find(r => r.id === routeId);
}
